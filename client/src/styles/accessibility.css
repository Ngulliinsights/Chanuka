/**
 * Accessibility Styles
 * WCAG 2.1 AA compliant styles and enhancements
 */

/* Screen Reader Only Content */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

.sr-only:focus,
.focus\:not-sr-only:focus {
  position: static;
  width: auto;
  height: auto;
  padding: inherit;
  margin: inherit;
  overflow: visible;
  clip: auto;
  white-space: normal;
}

/* High Contrast Mode */
.high-contrast {
  --background: 0 0% 100%;
  --foreground: 0 0% 0%;
  --card: 0 0% 100%;
  --card-foreground: 0 0% 0%;
  --popover: 0 0% 100%;
  --popover-foreground: 0 0% 0%;
  --primary: 0 0% 0%;
  --primary-foreground: 0 0% 100%;
  --secondary: 0 0% 90%;
  --secondary-foreground: 0 0% 0%;
  --muted: 0 0% 95%;
  --muted-foreground: 0 0% 0%;
  --accent: 0 0% 0%;
  --accent-foreground: 0 0% 100%;
  --destructive: 0 0% 0%;
  --destructive-foreground: 0 0% 100%;
  --border: 0 0% 0%;
  --input: 0 0% 0%;
  --ring: 0 0% 0%;
}

.high-contrast * {
  border-color: hsl(var(--border)) !important;
}

.high-contrast button,
.high-contrast [role="button"] {
  border: 2px solid hsl(var(--border)) !important;
}

.high-contrast img {
  filter: contrast(1.2) brightness(1.1);
}

/* Font Size Scaling */
.font-small {
  font-size: 14px;
}

.font-medium {
  font-size: 16px;
}

.font-large {
  font-size: 18px;
}

.font-extra-large {
  font-size: 20px;
}

.font-small h1 { font-size: 1.75rem; }
.font-small h2 { font-size: 1.5rem; }
.font-small h3 { font-size: 1.25rem; }
.font-small h4 { font-size: 1.125rem; }
.font-small h5 { font-size: 1rem; }
.font-small h6 { font-size: 0.875rem; }

.font-large h1 { font-size: 2.5rem; }
.font-large h2 { font-size: 2.25rem; }
.font-large h3 { font-size: 2rem; }
.font-large h4 { font-size: 1.75rem; }
.font-large h5 { font-size: 1.5rem; }
.font-large h6 { font-size: 1.25rem; }

.font-extra-large h1 { font-size: 3rem; }
.font-extra-large h2 { font-size: 2.75rem; }
.font-extra-large h3 { font-size: 2.5rem; }
.font-extra-large h4 { font-size: 2.25rem; }
.font-extra-large h5 { font-size: 2rem; }
.font-extra-large h6 { font-size: 1.75rem; }

/* Reduced Motion */
.reduced-motion *,
.reduced-motion *::before,
.reduced-motion *::after {
  animation-duration: 0.01ms !important;
  animation-iteration-count: 1 !important;
  transition-duration: 0.01ms !important;
  scroll-behavior: auto !important;
}

/* Enhanced Focus Indicators */
.enhanced-focus *:focus,
.enhanced-focus *:focus-visible {
  outline: 3px solid #2563eb !important;
  outline-offset: 2px !important;
  box-shadow: 0 0 0 5px rgba(37, 99, 235, 0.2) !important;
}

.enhanced-focus button:focus,
.enhanced-focus [role="button"]:focus,
.enhanced-focus a:focus,
.enhanced-focus input:focus,
.enhanced-focus select:focus,
.enhanced-focus textarea:focus {
  outline: 3px solid #2563eb !important;
  outline-offset: 2px !important;
  box-shadow: 0 0 0 5px rgba(37, 99, 235, 0.2) !important;
}

/* Screen Reader Optimizations */
.screen-reader-optimized {
  /* Add more descriptive content for screen readers */
}

.screen-reader-optimized button::after,
.screen-reader-optimized [role="button"]::after {
  content: " (button)";
  position: absolute;
  left: -10000px;
  width: 1px;
  height: 1px;
  overflow: hidden;
}

.screen-reader-optimized a[href^="http"]::after {
  content: " (external link)";
  position: absolute;
  left: -10000px;
  width: 1px;
  height: 1px;
  overflow: hidden;
}

/* Skip Links */
.skip-link {
  position: absolute;
  top: -40px;
  left: 6px;
  background: #2563eb;
  color: white;
  padding: 8px;
  text-decoration: none;
  border-radius: 4px;
  z-index: 1000;
  font-weight: 600;
  transition: top 0.3s;
}

.skip-link:focus {
  top: 6px;
}

/* Touch Target Sizes (WCAG 2.1 AA) */
@media (hover: none) and (pointer: coarse) {
  button,
  [role="button"],
  a,
  input[type="button"],
  input[type="submit"],
  input[type="reset"],
  input[type="checkbox"],
  input[type="radio"],
  select {
    min-height: 44px;
    min-width: 44px;
  }
  
  /* Ensure touch targets don't overlap */
  button + button,
  [role="button"] + [role="button"],
  a + a {
    margin-left: 8px;
  }
}

/* Color Contrast Helpers */
.contrast-aa {
  /* Ensure 4.5:1 contrast ratio for normal text */
  color: #1f2937; /* Dark gray on white background */
}

.contrast-aaa {
  /* Ensure 7:1 contrast ratio for enhanced contrast */
  color: #111827; /* Very dark gray on white background */
}

/* Error States with High Visibility */
.error-high-contrast {
  background-color: #fef2f2;
  border: 2px solid #dc2626;
  color: #991b1b;
}

.error-high-contrast:focus {
  outline: 3px solid #dc2626;
  outline-offset: 2px;
}

/* Success States with High Visibility */
.success-high-contrast {
  background-color: #f0fdf4;
  border: 2px solid #16a34a;
  color: #15803d;
}

.success-high-contrast:focus {
  outline: 3px solid #16a34a;
  outline-offset: 2px;
}

/* Warning States with High Visibility */
.warning-high-contrast {
  background-color: #fffbeb;
  border: 2px solid #d97706;
  color: #92400e;
}

.warning-high-contrast:focus {
  outline: 3px solid #d97706;
  outline-offset: 2px;
}

/* Keyboard Navigation Indicators */
.keyboard-navigation-active {
  /* Show visual indicators for keyboard users */
}

.keyboard-navigation-active *:focus {
  position: relative;
}

.keyboard-navigation-active *:focus::before {
  content: "";
  position: absolute;
  top: -4px;
  left: -4px;
  right: -4px;
  bottom: -4px;
  border: 2px dashed #2563eb;
  border-radius: 4px;
  pointer-events: none;
}

/* Loading States for Screen Readers */
.loading-announcement {
  position: absolute;
  left: -10000px;
  width: 1px;
  height: 1px;
  overflow: hidden;
}

/* Form Validation Styles */
.form-field-error input,
.form-field-error select,
.form-field-error textarea {
  border-color: #dc2626 !important;
  background-color: #fef2f2;
}

.form-field-error label {
  color: #dc2626;
}

.form-field-success input,
.form-field-success select,
.form-field-success textarea {
  border-color: #16a34a !important;
  background-color: #f0fdf4;
}

.form-field-success label {
  color: #15803d;
}

/* Modal and Dialog Accessibility */
.modal-backdrop {
  background-color: rgba(0, 0, 0, 0.75);
}

.modal-content {
  /* Ensure modal content is properly contained */
  max-height: 90vh;
  overflow-y: auto;
}

/* Table Accessibility */
table {
  border-collapse: collapse;
}

th {
  background-color: #f9fafb;
  font-weight: 600;
  text-align: left;
  padding: 12px;
  border: 1px solid #d1d5db;
}

td {
  padding: 12px;
  border: 1px solid #d1d5db;
}

/* Caption for tables */
caption {
  font-weight: 600;
  text-align: left;
  margin-bottom: 8px;
  color: #374151;
}

/* List Accessibility */
ul, ol {
  padding-left: 1.5rem;
}

li {
  margin-bottom: 0.25rem;
}

/* Definition Lists */
dt {
  font-weight: 600;
  margin-top: 1rem;
}

dd {
  margin-left: 1rem;
  margin-bottom: 0.5rem;
}

/* Abbreviations */
abbr[title] {
  text-decoration: underline dotted;
  cursor: help;
}

/* Code Accessibility */
code {
  background-color: #f3f4f6;
  padding: 0.125rem 0.25rem;
  border-radius: 0.25rem;
  font-family: ui-monospace, SFMono-Regular, "SF Mono", Consolas, "Liberation Mono", Menlo, monospace;
  font-size: 0.875em;
}

pre {
  background-color: #f3f4f6;
  padding: 1rem;
  border-radius: 0.5rem;
  overflow-x: auto;
  font-family: ui-monospace, SFMono-Regular, "SF Mono", Consolas, "Liberation Mono", Menlo, monospace;
}

/* Print Accessibility */
@media print {
  .skip-link,
  .accessibility-trigger,
  .modal-backdrop,
  .tooltip {
    display: none !important;
  }
  
  a[href^="http"]:after {
    content: " (" attr(href) ")";
    font-size: 0.8em;
    color: #666;
  }
  
  abbr[title]:after {
    content: " (" attr(title) ")";
    font-size: 0.8em;
    color: #666;
  }
}

/* Animation Preferences */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* Color Scheme Preferences */
@media (prefers-color-scheme: dark) {
  .auto-dark {
    --background: 222.2 84% 4.9%;
    --foreground: 210 40% 98%;
    --card: 222.2 84% 4.9%;
    --card-foreground: 210 40% 98%;
    --popover: 222.2 84% 4.9%;
    --popover-foreground: 210 40% 98%;
    --primary: 210 40% 98%;
    --primary-foreground: 222.2 84% 4.9%;
    --secondary: 217.2 32.6% 17.5%;
    --secondary-foreground: 210 40% 98%;
    --muted: 217.2 32.6% 17.5%;
    --muted-foreground: 215 20.2% 65.1%;
    --accent: 217.2 32.6% 17.5%;
    --accent-foreground: 210 40% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 210 40% 98%;
    --border: 217.2 32.6% 17.5%;
    --input: 217.2 32.6% 17.5%;
    --ring: 212.7 26.8% 83.9%;
  }
}

/* Contrast Preferences */
@media (prefers-contrast: high) {
  :root {
    --border: 0 0% 0%;
    --foreground: 0 0% 0%;
    --card: 0 0% 100%;
  }
  
  button,
  [role="button"],
  input,
  select,
  textarea {
    border: 2px solid black !important;
  }
  
  a {
    text-decoration: underline !important;
    color: #0000EE !important;
  }
  
  a:visited {
    color: #551A8B !important;
  }
}

/* Focus Management */
.focus-trap {
  /* Styles for focus trap containers */
}

.focus-trap *:focus {
  outline: 3px solid #2563eb;
  outline-offset: 2px;
}

/* Landmark Roles */
[role="banner"],
[role="navigation"],
[role="main"],
[role="complementary"],
[role="contentinfo"] {
  /* Ensure landmarks are properly styled */
}

/* ARIA Live Regions */
[aria-live="polite"],
[aria-live="assertive"] {
  position: absolute;
  left: -10000px;
  width: 1px;
  height: 1px;
  overflow: hidden;
}

/* Status Messages */
.status-message {
  padding: 12px 16px;
  border-radius: 6px;
  margin: 8px 0;
  font-weight: 500;
}

.status-message[role="status"] {
  background-color: #dbeafe;
  border: 1px solid #3b82f6;
  color: #1e40af;
}

.status-message[role="alert"] {
  background-color: #fef2f2;
  border: 1px solid #ef4444;
  color: #dc2626;
}

/* Tooltip Accessibility */
.tooltip {
  position: absolute;
  z-index: 1000;
  padding: 8px 12px;
  background-color: #1f2937;
  color: white;
  border-radius: 6px;
  font-size: 0.875rem;
  max-width: 200px;
  word-wrap: break-word;
}

.tooltip[role="tooltip"] {
  /* Ensure tooltips are properly announced */
}

/* Progress Indicators */
.progress-bar {
  background-color: #e5e7eb;
  border-radius: 9999px;
  overflow: hidden;
}

.progress-bar-fill {
  height: 100%;
  background-color: #3b82f6;
  transition: width 0.3s ease;
}

.progress-bar[aria-valuenow] {
  /* Ensure progress is announced to screen readers */
}

/* Breadcrumb Navigation */
.breadcrumb {
  display: flex;
  align-items: center;
  flex-wrap: wrap;
  gap: 8px;
}

.breadcrumb-separator {
  color: #6b7280;
  user-select: none;
}

.breadcrumb-current {
  font-weight: 600;
  color: #374151;
}

/* Card Accessibility */
.card-interactive {
  cursor: pointer;
  transition: all 0.2s ease;
}

.card-interactive:hover {
  transform: translateY(-2px);
  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
}

.card-interactive:focus {
  outline: 3px solid #2563eb;
  outline-offset: 2px;
}

/* Responsive Text */
@media (max-width: 640px) {
  .responsive-text-sm {
    font-size: 0.875rem;
  }
  
  .responsive-text-base {
    font-size: 1rem;
  }
  
  .responsive-text-lg {
    font-size: 1.125rem;
  }
}

@media (min-width: 641px) {
  .responsive-text-sm {
    font-size: 1rem;
  }
  
  .responsive-text-base {
    font-size: 1.125rem;
  }
  
  .responsive-text-lg {
    font-size: 1.25rem;
  }
}